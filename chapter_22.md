# Тестирование, выполняемое разрабочиками

**Тестирование** – самая популярная методика повышения качества ПО.

Виды тестирования:

- **Юнит-тестирование (блочное тестирование)** – тестирование класса, метода или небольшого приложения (написанного одним разрабочиком) отдельно от прочих частей системы.
- **Тестирование компонента** – тестирование класса или небольшого приложения (написанного несколькими разрабочиками) отдельно от прочих частей системы.
- **Интеграционное тестирование** – совместное тестирование двух или более классов или приложений.
- **Регрессионное тестирование** – повторное выполнение тестов после внесения в программу каких-либо изменений.
- **Тестирование системы** – тестирование ПО в его окончательной конфигурации для выявления ошибок, которые невозможно выявить на более низком уровне интеграции.

## Тестирование и качество ПО

> Тестирование – важная составляющая контроля качества, а зачастую и единственная (с. 492)

Исследования показывают, что тестирование может обеспечить обнаружение в среднем до 60% ошибок. Поэтому не стоит полагаться только на тестирование. Лучше комбинировать его [с другими методиками контроля качества](chapter_20.md#относительная-эффективность-методик-повышения-контроля-качества-ПО).

- **Зеленые тесты не доказывают отсутсвия ошибок.** Возможно, у вас безупречный код, а может быть – плохие тесты.
- **Код не станет лучше от того, что вы напишете много тестов.** Тесты – это возможность найти ошибки и гарантировать себе, что работоспособность хотя бы каких-то сценариев вы сможете проверять автоматически.
- Тесты должны охватывать как можно больше сценариев выполнения вашей программы. Если вы не рассчитываете найти ошибки в своём коде, скорее всего вы их и не найдёте.

## Рекомендуемый подход

- Тестируйте программу на предмет реализации требований, описанных в проекте.
- Тестируйте программу на предмет реализации каждого значимого аспекта проектирования.
- Добавьте детальные тесты для каждого компонента системы, используя «базисное тестирование» (basis testing).
- Используйте чек-лист для проверки часто встречающихся ошибок.
- Чем раньше вы напишете тесты, тем лучше.

> ...программирование с изначальными тестами (test-driven development, TDD) – одна из самых эффективных методик разработки ПО, возникших в последнее десятилетие (с. 495)

- Старайтесь писать не только чистые тесты, которые проверяют, что метод работает, но и грязные тесты, которые проверяют _как метод не работает_, например, что он возвращает опредённое сообщение об ошибке.

## Приёмы

> Почему невозможно доказать корректность программы, протестировав её? Чтобы доказать полную работоспособность программы, вы должны были бы протестировать ее со всеми возможными входными значениями и их комбинациями (с. 496)

И так как исчерпывающее тестирование невозможно, на практике нужно выбирать тесты, которые помогут обеспечить максимальную вероятность обнаружения ошибок.

- **Структурированное базисное тестирование (structured basis testing)**. Напишите минимальный набор тестов, который будет покрывать все возможные логические ветви программы.

- **Тестирование потоков данных**. Напишите набор тестов, который будет покрывать все возможные комбинации данных, с которыми может работать метод. Недостаточно протестировать логическую ветвь, нужно протестировать все способы, которыми программа может прийти к этой ветви.

- **Угадывание ошибок**. Напишите тесты, учитывающие вероятные источники ошибок. Используйте наборы _плохих_ (неполные, неверные, избыточные) и _хороших_ данных (ожидаемые, минимальные и максимальные допустимые, совместимые с предыдущей версией).

## Ошибки

Ошибки не распределяются по коду равномерно. Большинство ошибок может быть сконцентрировано в нескольких классах или методах.

Многие ошибки не связаны с разработкой. Так, причиной ошибок часто становятся:

- плохое знание предметной области,
- изменения или конфликты требований,
- неэффективность коммуникации и плохая координация действий разработчиков.

> Посвящайте анализу проекта столько времени, сколько нужно (с. 510)

## Инструменты

**Средства упрощения тестирования**:

- Объекты-заглушки ([stub-, mock-objects](https://en.wikipedia.org/wiki/Mock_object)) для имитации реальных объектов, функций методов и так далее
- Драйвер или тест-раннер ([test harness](https://en.wikipedia.org/wiki/Test_harness)) для гибкого и удобного запуска тестов
- Фиктивные файлы для подмены реальных файлов

**Генераторы тестовых данных.** В некоторых случаях лучше генерировать данные для программы на ходу, а не использовать готовые наборы данных. Существуют готовые инструменты для генерации таких данных, как электронная почта, адрес, индекс и тому подобное.

**Code-coverage tools.** Средства оценки покрытия помогают измерить долю кода, которая покрыта тестами.

**Регистраторы ошибок.** Такие инструменты собирают информацию об ошибке и отправляют её разработчиками.

**Инструменты возмущения состояния системы.** Помогают привести систему в экстремальное состояние, например, спровоцировать недостаток или перераспределение оперативной памяти.

## Оптимизация процесса тестирования

Чтобы оптимизировать процесс тестирования, нужно (а) планировать тестирование, также как и основной процесс разработки, и (б) регулярно проводить регрессионное тестирование.

**Единственным практичным способом регулярно проводить регрессионное тестирование является автоматизация**, которая позволяет:

- снизить вероятность ошибок, воникающих в процессе ручного тестирования,
- выполнять тесты чаще,
- быстрее выявлять ошибки за счёт этой частотности.

Сегодня автоматическое тестирование является частью процесса CI/CD в большинстве проектов.
