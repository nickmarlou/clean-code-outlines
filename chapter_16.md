# Циклы

> Цикл – это неформальное обозначение любой структуры итеративного типа, т.е. такой, которая заставляет программу повторно выполнять некий блок кода (c. 359)

Основные виды циклов:

-  Цикл с подсчетом (выполняется определенное количество раз)
-  Постоянно вычисляемый цикл (проверяет необходимость завершения на каждой итерации)
-  Бесконечный цикл
-  Цикл с итератором (выполняется для всех элементов итерируемой структуры данных, например, массива)

## Выбор типа циклов

### Когда использовать цикл `while`

Если вы заранее не знаете, сколько итераций должен выполнить цикл, используйте `while`. Проверка выхода из цикла выполняется один раз за итерацию. Главным вопросом является выбор места этой проверки – в начале или в конце цикла. Если проверка выхода выполняется в начале, то тело не обязательно будет выполняться. Если цикл проверяется в конце, то тело выполнится минимум один раз.

### Когда использовать цикл `for`

Если вы знаете, сколько итераций должен выполняться цикл, используйте `for`. Он отлично подходит для простых случаев, не требующих управления изнутри тела цикла.

### Когда использовать цикл `foreach`

Цикл `foreach` полезен для выполнения действий над каждым элементом массива или любой другой итерируемой структуры данных.

## Управление циклом

> ...минимизируйте число факторов, влияющих на цикл. Упрощайте, упрощайте и ещё раз упрощайте!

> ...рассматривайте содержимое цикла так, будто это метод: вынесите за пределы цикла всё управление, какое только возможно (с. 365)

### Вход в цикл

Основные принципы:

- Вход в цикл должен быть описан в одном месте
- Операторы инициализации цикла должны находиться прямо перед циклом
- Используйте `while(true)` для бесконечных циклов
- Используйте `for`, если он применим в вашем случае, потому что он проще для чтения и понимания

### Обработка середины

Основные принципы:

- Следите, чтобы цикл, как и функция, выполнял только одну задачу (не объяединяйте циклы ради улучшения производительности, пока не убедитесь, что проблема производительности в этом месте реально существует)
- Используйте скобки для обрамления логических выражений в теле цикла, чтобы улучшить их читаемость
- Располагайте служебные операции (например, `i = i + 1` и так далее) в начале или конце цикла
- Избегайте пустых циклов

### Выход из цикла

Основные приципы:

- Убедитесь, чтобы вы предусмотрели все сценарии выходы из цикла: и стандартные ситуации, и исключительные ситуации
- Сделайте условия выхода из цикла простым и очевидным
- Не манипулируйте счётчиком вручную (!) для выхода из цикла
- Не используйте значение счетчика цикла после завершения цикла
- Рассмотрите применение счётчиков безопасности, которые будут проверять не выполняется ли цикл слишком большое количество раз, и сообщать, если это произошло (выбрасывать исключение, записывать логи или метрику для мониторинга)

#### Досрочный выход из цикла (`break` и `continue`)

Во многих языках можно завершить цикл, не дожидаясь выполнения стандартного условия выхода из цикла.

Так, оператор `break` завершает цикл и продолжает выполнение программы после цикла, а оператор `continue` пропускает текушую итерацию цикла и начинает следующую.

Основные принципы:

- Используйте `break` вместо множества логических выражений в цикле `while`
- Используйте `continue` для проверок в начале тела цикла
- Если вы не можете аргументировать применение `break` и `continue`, не применяйте их
- Множество операторов `break`, разбросанных по всему коду, – это тревожный сигнал, свидетельствующий о том, что необходимо провести рефакторинг

## Насколько длинным может быть цикл?

- Желательно, чтобы цикл можно было увидеть на мониторе целиком
- Ограничивайте вложенность цикла тремя уровнями
- Выделяйте внутреннюю часть длинных циклов в отдельные методы или функции
- Чем длиннее цикл, тем больше внимания следует уделять ясности и простоте цикла